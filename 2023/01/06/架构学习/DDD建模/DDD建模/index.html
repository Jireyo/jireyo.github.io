

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=light>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/favicon.png">
  <link rel="icon" href="/img/favicon.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#727679">
  <meta name="author" content="Jin">
  <meta name="keywords" content="">
  
    <meta name="description" content="DDD入门DDD介绍微服务拆分的困境不知道业务或者微服务的边界在哪里？ DDD的核心思想DDD核心思想是通过领域驱动设计方法定义领域模型，从而确定业务和应用边界，保证业务模型与代码模型的一致性。 DDD实现DDD是一种架构设计方法，它通过边界划分将复杂业务领域简单化，帮我们设计出清晰的领域和应用边界，可以很容易的实现架构演进。 DDD战略设计（设计阶段，关注系统划分与术语定义）  在事件风暴中梳理">
<meta property="og:type" content="article">
<meta property="og:title" content="DDD建模语言圣经">
<meta property="og:url" content="http://example.com/2023/01/06/%E6%9E%B6%E6%9E%84%E5%AD%A6%E4%B9%A0/DDD%E5%BB%BA%E6%A8%A1/DDD%E5%BB%BA%E6%A8%A1/index.html">
<meta property="og:site_name" content="Jin&#39;s Blog">
<meta property="og:description" content="DDD入门DDD介绍微服务拆分的困境不知道业务或者微服务的边界在哪里？ DDD的核心思想DDD核心思想是通过领域驱动设计方法定义领域模型，从而确定业务和应用边界，保证业务模型与代码模型的一致性。 DDD实现DDD是一种架构设计方法，它通过边界划分将复杂业务领域简单化，帮我们设计出清晰的领域和应用边界，可以很容易的实现架构演进。 DDD战略设计（设计阶段，关注系统划分与术语定义）  在事件风暴中梳理">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/Pasted%20image%2020231031194055.png">
<meta property="og:image" content="http://example.com/Pasted%20image%2020231031193011.png">
<meta property="og:image" content="http://example.com/Pasted%20image%2020231031193049.png">
<meta property="og:image" content="http://example.com/Pasted%20image%2020231031193227.png">
<meta property="og:image" content="http://example.com/Pasted%20image%2020231031194150.png">
<meta property="og:image" content="http://example.com/Pasted%20image%2020231028201816.png">
<meta property="og:image" content="http://example.com/Pasted%20image%2020231031194238.png">
<meta property="og:image" content="http://example.com/Pasted%20image%2020231028201843.png">
<meta property="og:image" content="http://example.com/Pasted%20image%2020231028201903.png">
<meta property="og:image" content="http://example.com/Pasted%20image%2020231028201926.png">
<meta property="og:image" content="http://example.com/Pasted%20image%2020231028202046.png">
<meta property="og:image" content="http://example.com/Pasted%20image%2020231028202123.png">
<meta property="og:image" content="http://example.com/Pasted%20image%2020231029013115.png">
<meta property="og:image" content="http://example.com/Pasted%20image%2020231029013045.png">
<meta property="og:image" content="http://example.com/Pasted%20image%2020231031183128.png">
<meta property="og:image" content="http://example.com/Pasted%20image%2020231031185337.png">
<meta property="article:published_time" content="2023-01-06T11:00:55.000Z">
<meta property="article:modified_time" content="2024-05-17T13:30:22.946Z">
<meta property="article:author" content="Jin">
<meta property="article:tag" content="DDD">
<meta property="article:tag" content="架构学习">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://example.com/Pasted%20image%2020231031194055.png">
  
  
  
  <title>DDD建模语言圣经 - Jin&#39;s Blog</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  



  
<link rel="stylesheet" href="/css/fluid-extention.css">



  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.9.3","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":"#"},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml"};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 6.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong style="color: #fff;">Jin&#39;s Blog</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                首页
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                文章
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" target="_self" href="javascript:;" role="button"
                 data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                <i class="iconfont icon-books"></i>
                归档
              </a>
              <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                
                  
                  
                  
                  <a class="dropdown-item" href="/categories/">
                    <i class="iconfont icon-category-fill"></i>
                    分类
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/tags/">
                    <i class="iconfont icon-tags-fill"></i>
                    标签
                  </a>
                
              </div>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                关于
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              &nbsp;<i class="iconfont icon-search"></i>&nbsp;
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/background.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="DDD建模语言圣经"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2023-01-06 19:00" pubdate>
          2023年1月6日 晚上
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          10k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          85 分钟
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">DDD建模语言圣经</h1>
            
            
              <div class="markdown-body">
                
                <h1 id="DDD入门"><a href="#DDD入门" class="headerlink" title="DDD入门"></a>DDD入门</h1><h2 id="DDD介绍"><a href="#DDD介绍" class="headerlink" title="DDD介绍"></a>DDD介绍</h2><p><em>微服务拆分的困境</em><br>不知道业务或者微服务的<strong>边界</strong>在哪里？</p>
<p><em>DDD的核心思想</em><br>DDD核心思想是通过领域驱动设计方法定义领域模型，从而<strong>确定业务和应用边界</strong>，<strong>保证业务模型与代码模型的一致性</strong>。</p>
<p><em>DDD实现</em><br>DDD是一种<strong>架构设计方法</strong>，它通过边界划分将复杂业务领域简单化，帮我们设计出清晰的领域和应用边界，可以很容易的实现架构演进。</p>
<p><em>DDD战略设计（设计阶段，关注系统划分与术语定义）</em><br><img src="/Pasted%20image%2020231031194055.png" srcset="/img/loading.gif" lazyload></p>
<ol>
<li>在事件风暴中梳理业务过程中的用户操作、事件以及外部依赖关系等，根据这些要素<strong>梳理出领域实体等领域对象</strong>。</li>
<li>根据领域实体之间的业务关联性，<strong>将业务紧密相关的实体进行组合形成聚合</strong>，确定聚合中的聚合根、值对象和实体。在这个图里，聚合之间的边界是第一层边界，它们在同一个微服务实例中运行，这个边界是逻辑边界，所以用虚线表示。</li>
<li>根据业务及语义边界等因素，<strong>将一个或者多个聚合划定在一个限界上下文内，形成领域模型</strong>。在这个图里，限界上下文之间的边界是第二层边界，这一层边界可能就是未来微服务的边界，不同限界上下文内的领域逻辑被隔离在不同的微服务实例中运行，物理上相互隔离，所以是物理边界，边界之间用实线来表示。</li>
</ol>
<p><em>DDD的战术设计（实施阶段，关注子系统的代码实现）</em><br>将领域模型中的领域对象与代码模型中的代码对象建立映射关系，将业务架构和系统架构进行绑定。当我们去响应业务变化调整业务架构和领域模型时，系统架构也会同时发生调整并同步建立新的映射关系。</p>
<p><em>DDD与微服务的关系</em><br>DDD 是一种<strong>架构设计方法</strong>，微服务是一种<strong>架构风格</strong>，两者从本质上都是为了追求高响应力，而从业务视角去分离应用系统建设复杂度的手段。两者都强调从业务出发，其核心要义是强调根据业务发展，合理划分领域边界，持续调整现有架构，优化现有代码，以保持架构和代码的生命力，也就是我们常说的<strong>演进式架构</strong>。</p>
<ul>
<li>DDD 主要关注：从业务领域视角划分领域边界，构建通用语言进行高效沟通，通过业务抽象，建立领域模型，维持业务和代码的逻辑一致性。</li>
<li>微服务主要关注：运行时的进程间通信、容错和故障隔离实现去中心化数据管理和去中心化服务治理，关注微服务的独立开发、测试、构建和部署。</li>
<li>DDD可以用于微服务设计，解决微服务设计过程中边界难以划定的难题。</li>
</ul>
<p><em>DDD大图</em><br><img src="/Pasted%20image%2020231031193011.png" srcset="/img/loading.gif" lazyload></p>
<h2 id="DDD基础概念"><a href="#DDD基础概念" class="headerlink" title="DDD基础概念"></a>DDD基础概念</h2><p><img src="/Pasted%20image%2020231031193049.png" srcset="/img/loading.gif" lazyload></p>
<h3 id="领域与子域"><a href="#领域与子域" class="headerlink" title="领域与子域"></a>领域与子域</h3><p><em>领域</em><br>DDD 的<strong>领域</strong>就是这个边界内要解决的业务问题域。<br><em>子域</em><br>领域可以进一步划分为子领域。我们把划分出来的多个子领域称为<strong>子域</strong>，每个子域对应一个<br>更小的问题域或更小的业务范围。</p>
<h3 id="核心域、通用域与支撑域"><a href="#核心域、通用域与支撑域" class="headerlink" title="核心域、通用域与支撑域"></a>核心域、通用域与支撑域</h3><p>在领域不断划分的过程中，领域会细划分为三类子域，它们分别是: 核心域、通用域和支撑域。<br>为不同的子域，子域可以根据自身重要性和功能属性。<br><em>核心域</em><br>决定产品和公司核心竞争力的子域，它是业务成功的主要因素和公司的核心竞争力。<br><em>通用域</em><br>同时被多个子域使用的通用功能子域。（如权限、认证系统）<br><em>支撑域</em><br>必需的子域，但既不包含决定产品和公司核心竞争力的功能，也不包含通用功能。（如数据字典等系统）</p>
<h3 id="通用语言与限界上下文"><a href="#通用语言与限界上下文" class="headerlink" title="通用语言与限界上下文"></a>通用语言与限界上下文</h3><p><em>通用语言与限界上下文的解释</em><br>通用语言定义上下文含义，限界上下文则定义领域边界，以确保每个上下文含义在它特定的边界内都具有唯一的含义，领域模型则存在于这个边界之内。<br><em>通用语言</em><br>在事件风暴过程中，通过团队交流达成共识的，<strong>能够简单、清晰、准确描述业务涵义和规则的语言</strong>就是通用语言。<br>通用语言包括术语和用例场景：</p>
<ul>
<li>通用语言中的名词可以给领域对象命名，对应实体对象</li>
<li>通用语言中的动词表示一个动作或事件，对应领域事件或命令</li>
</ul>
<p><img src="/Pasted%20image%2020231031193227.png" srcset="/img/loading.gif" lazyload></p>
<blockquote>
<p>设计过程中我们可以用一些表格,来记录事件风暴和微服务设计过程中产生的领域对象及其属性。DDD 分析和设计过程中的每一个环节都需要保证限界上下文内术语的统一，在代码模型设计的时侯就要建立领域对象和代码对象的一一映射，从而保证业务模型和代码模型的一致，实现业务语言与代码语言的统一。</p>
</blockquote>
<p><em>限界上下文</em><br>通用语言也有它的上下文环境。为了避免同样的概念或语义在不同的上下文环境中产生歧义，DDD 在战略设计上提出了“限界上下文”这个概念，用来<strong>确定语义所在的领域边界</strong>（可以理解为业务的上下文环境）。<br><strong>领域边界就是通过限界上下文来定义的</strong>。</p>
<p><em>限界上下文与微服务</em><br>子域可能会包含多个限界上下文，也有可能子域本身的边界就是限界上下文边界，但每个领域模型都有它对应的限界上下文。理论上限界上下文就是微服务的边界，将限界上下文内的领域模型映射到微服务，就完成了从问题域到软件的解决方案。</p>
<h3 id="实体与值对象"><a href="#实体与值对象" class="headerlink" title="实体与值对象"></a>实体与值对象</h3><p><em>实体</em><br>实体拥有唯一标识符，且标识符在历经各种状态变更后仍能保持一致。</p>
<ul>
<li>业务形态：实体和值对象是组成领域模型的基础单元</li>
<li>代码形态：实体的表现为实体类，在 DDD 里，这些实体类通常采用充血模型，与这个实体相关的所有业务逻辑都在实体类的方法中实现，跨多个实体的领域逻辑则在领域服务中实现。</li>
<li>运行形态：实体以领域对象的形式存在，每个实体对象都有唯一的ID。</li>
<li>数据库形态：多数情况下实体与持久化对象是一对一，但复杂场景下可能出现一对多或多对一的场景。</li>
</ul>
<p><em>值对象</em><br>通过对象属性值来识别的对象，它<strong>将多个相关属性组合为一个概念整体</strong>。在 DDD 中用来描述领域的特定方面，并且是个没有标识符的对象，叫作值对象（如人员的地址，包括省市区街道等多个属性）。</p>
<ul>
<li>业务形态：值对象只是若干个属性的集合，只有数据初始化操作和有限的不涉及修改数据的行为，基本不包含业务逻辑。值对象的属性集虽然在物理上独立出来了，但在逻辑上它仍然是实体属性的一部分，用于描述实体的特征。</li>
<li>代码形态：单一属性直接定义为实体类的属性，属性集合一般设计为Class类。</li>
<li>运行形态：值对象运行时嵌入到实体，主要有<strong>属性嵌入</strong>和<strong>序列化大对象</strong>嵌入两种方式：<ul>
<li>属性嵌入：提升数据库性能，但若值对象过多，会导致实体堆积一堆缺乏完整性的属性。</li>
<li>序列化大对象：简化数据库设计，但无法满足基于值对象的快速查询。</li>
</ul>
</li>
<li>数据库形态：根据值对象与实体对象的属性值是否保存在同一个数据库实体表分为两者方案。在同一个表中时破坏了业务涵义和概念完整性；不在同一个表则增加了不必要的实体和表，增加了数据库设计的复杂性。</li>
</ul>
<p><em>总结</em><br>DDD 提倡从领域模型设计出发，而不是先设计数据模型。<br>在领域建模时，我们可以将部分对象设计为值对象，保留对象的业务涵义，同时又减少了实体的数量；在数据建模时我们可以将值对象嵌入实体，减少实体表的数量，简化数据库设计。</p>
<h3 id="聚合和聚合根"><a href="#聚合和聚合根" class="headerlink" title="聚合和聚合根"></a>聚合和聚合根</h3><p><em>聚合</em><br>领域模型内的实体和值对象就好比个体，而能<strong>让实体和值对象协同工作的组织就是聚合</strong>，它用来确保这些领域对象在实现共同的业务逻辑时，能保证数据的一致性。</p>
<blockquote>
<p>可以认为聚合就是由业务和逻辑紧密关联的实体和值对象组合而成的，聚合是数据修改和持久化的基本单元，每一个聚合对应一个仓储，实现数据的持久化</p>
</blockquote>
<p>聚合有一个聚合根和上下文边界，这个边界根据业务<strong>单一职责和高内聚原则</strong>，定义了聚合内部应该包含哪些实体和值对象，而聚合之间的边界是松耦合的。</p>
<p><em>聚合根</em><br>如果把聚合比作组织，那聚合根就是这个组织的负责人。聚合根也称为根实体，它不仅是<strong>实体</strong>，还是<strong>聚合的管理者</strong>，以及<strong>聚合对外的接口人</strong>。其以聚合根ID关联的方式接受外部任务和请求，在上下文内实现聚合之间的业务协同。</p>
<p><em>聚合设计过程</em></p>
<ol>
<li>事件风暴，梳理实体和值对象</li>
<li>选择聚合根实体</li>
<li>根据单一职责和高内聚原则，找出与聚合根关联的所有紧密依赖的实体和值对象。</li>
<li>根据聚合根、实体、值对象的依赖关系，画出对象的引用和依赖模型。</li>
<li>多个聚合根据业务语义和上下文划分到一个限界上下文</li>
</ol>
<p><em>聚合设计原则</em></p>
<ol>
<li>在一致性边界内建模真正的不变条件</li>
<li>设计小聚合</li>
<li>通过唯一标识引用其他聚合</li>
<li>在边界之外使用最终一致性（聚合内数据强一致性）</li>
<li>通过应用层实现跨聚合的服务调用（便于未来以聚合为单位的微服务组合和拆分）</li>
<li>根据实际情况和要求可以适当突破原则</li>
</ol>
<p><em>总结</em></p>
<ul>
<li>聚合的特点: 高内聚、低耦合，它是领域模型中最底层的边界，可以作为拆分微服务的最小单位，但我不建议你对微服务过度拆分。但在对性能有极致要求的场景中，聚合可以独立作为一个微服务，以满足版本的高频发布和极致的弹性伸缩能力。一个微服务可以包合多个聚合，聚合之间的边界是微服务内天然的逻辑边界。有了这个逻辑边界，在微服务架构演进时就可以以聚合为单位进行拆分和组合了，微服务的架构演进也就不再是一件难事了</li>
<li>聚合根的特点: 聚合根是实体，有实体的特点，具有全局唯一标识，有独立的生命周期。一个聚合只有一个聚合根，聚合根在聚合内对实体和值对象采用直接对象引用的方式进行组织和协调，聚合根与聚合根之间通过 ID 关联的方式实现聚合之间的协同。</li>
<li>实体的特点: 有ID标识，通过D 判断相等性，ID 在聚合内唯一即可。状态可变，它依附于聚合根，其生命周期由聚合根管理。实体一般会持久化，但与数据库持久化对象不一定是对一的关系。实体可以引用聚合内的聚合根、实体和值对象</li>
<li>值对象的特点：无ID，不可变，无生命周期，用完即扔。值对象之间通过属性值判断相等性。它的核心本质是值，是一组概念完整的属性组成的集合，用于描述实体的状态和特征值对象尽量只引用值对象</li>
</ul>
<h3 id="领域事件"><a href="#领域事件" class="headerlink" title="领域事件"></a>领域事件</h3><p><em>定义</em><br>领域事件用来表示领域中发生的事件。一个领域事件将导致进一步的业务操作。<br><strong>领域事件驱动设计</strong>可以切断领域模型之间的强依赖关系，事件发布完成后，发布方不必关心后续订阅方事件处理是否成功，这样可以实现领域模型的解耦，维护领域模型的独立性和数据的一致性。在领域模型映射到微服务系统架构时，领域事件可以解耦微服务，微服务之间的数据不必要求强一致性，而是基于事件的<strong>最终一致性</strong>。</p>
<p><em>微服务内的领域事件</em><br>微服务内应用服务不一定需要引入消息中间件，但一个事件若涉及到多个聚合，需要考虑引入事件总线，但也需要考虑其开发成本。<br>微服务内应用服务，可以通过跨聚合的服务编排和组合，以服务调用的方式完成跨聚合的访问，这种方式通常应用于实时性和数据一致性要求高的场景。这个过程会用到分布式事务以保证发布方和订阅方的数据同时更新成功。</p>
<p><em>微服务之间的领域事件</em><br>跨微服务的领域事件会在不同的限界上下文或领域模型之间实现业务协作，其主要目的是实现微服务解耦，减轻微服务之间实时服务访问的压力。<br>跨微服务的事件机制要总体考虑事件构建、发布和订阅、事件数据持久化、消息中间件，甚至事件数据持久化时还可能需要考虑引入分布式事务机制（确保数据一致性）等。</p>
<p><em>领域事件总体架构</em><br>领域事件处理包括：<strong>事件构建和发布、事件数据持久化、事件总线、消息中间件、事件接受和处理</strong>等。</p>
<ol>
<li>事件构建与发布：<ol>
<li>事件基本属性：事件唯一标识、发生时间、类型、来源。为保证事件结构统一，一般会创建事件基类，子类可扩充属性和方法。</li>
<li>事件发布前需要构建事务实体并持久化，发布的方式可以为事务总线或消息中间件等。</li>
</ol>
</li>
<li>事件数据持久化：用于系统之间数据对账，持久化有两种方案：<ol>
<li>持久化到本地业务数据库的事件表中，利用本地事务保证业务和事件数据的一致性。</li>
<li>持久化到共享事件数据库中，为了保证业务数据与事件数据的一致性，可能需要使用分布式事务来保证强一致性。</li>
</ol>
</li>
<li>事件总线：提供事件分发和接受等服务。<ol>
<li>微服务内的消费者：直接分发</li>
<li>微服务外的消费者：持久化后异步发送到消息中间件</li>
<li>混合消费者：先分发内部订阅者，后持久化后异步发送到微服务外。</li>
</ol>
</li>
<li>消息中间件：跨微服务的领域事件大多会用到消息中间件</li>
<li>事件接受与处理：订阅方次啊用监听机制，完成事件数据的持久化后即可进行下一步业务处理。</li>
</ol>
<h2 id="DDD分层架构"><a href="#DDD分层架构" class="headerlink" title="DDD分层架构"></a>DDD分层架构</h2><p><em>依赖倒置</em><br><img src="/Pasted%20image%2020231031194150.png" srcset="/img/loading.gif" lazyload><br>领域层为软件的核心，实现了各层对基础层的解耦。</p>
<p><em>DDD分层</em><br><img src="/Pasted%20image%2020231028201816.png" srcset="/img/loading.gif" lazyload></p>
<ol>
<li>用户接口层：负责向用户显示信息和解释用户指令。</li>
<li>应用层：主要面向用例和流程相关的操作，可协调多个聚合服务和领域对象。</li>
<li>领域层：实现核心业务逻辑，包括聚合根，实体，值对象，领域服务等领域模型。</li>
<li>基础层：贯穿所有层，为其他各层提供通用的技术和基础服务，如数据库访问实现。基础层采用了依赖倒置的设计，应用层通过解耦保持了独立的核心业务逻辑。</li>
</ol>
<p><em>DDD分层的原则</em><br>架构根据耦合的紧密程度分为：严格分层架构和松散分层架构，优化后的DDD分层属于严格分层架构，每层只能与位于其下的层发送耦合。</p>
<p><em>三层架构到DDD分层</em><br><img src="/Pasted%20image%2020231031194238.png" srcset="/img/loading.gif" lazyload><br>DDD分层架构的基础资源访问都采用了仓储设计模式，即通过依赖倒置实现各层对基础资源的解耦，仓库接口放在领域层，仓库实现放在基础层。</p>
<h2 id="微服务架构模型"><a href="#微服务架构模型" class="headerlink" title="微服务架构模型"></a>微服务架构模型</h2><p><em>整洁架构</em><br>又称洋葱架构，体现了分层的设计思想。越往里依赖越低，代码级别越高，越是核心能力。内圆不需要知道外圆的任何情况。<br><img src="/Pasted%20image%2020231028201843.png" srcset="/img/loading.gif" lazyload></p>
<p><em>六边形架构</em><br>核心理念：应用是通过端口与外部进行交互的。即核心业务逻辑与外部资源完全隔离，仅通过适配器进行交互，其解决了业务逻辑与用户界面的代码交错问题，实现了前后端分离，其他各层依赖关系与整洁架构类似。<br><img src="/Pasted%20image%2020231028201903.png" srcset="/img/loading.gif" lazyload><br>六边形架构的一个端口可能对应多个外部系统，不同外部系统也可能会使用不同的适配器。</p>
<p><em>模型对比分析</em><br><img src="/Pasted%20image%2020231028201926.png" srcset="/img/loading.gif" lazyload><br>都是以领域模型为中心的设计思想，都考虑了前端需求的变与领域模型的不变。</p>
<p><em>中台</em><br>中台：本质上是领域的子域，通常认为阿里的中台对应DDD的通用域。</p>
<p><em>中台与微服务设计</em></p>
<ol>
<li>中台建设要站在企业高度考虑能力的共享和复用。</li>
<li>微服务要有合理的架构分层。</li>
<li>应用资源的解耦和适配：通过仓储模式，采用依赖倒置的设计方法，屏蔽资源变更对业务代码的影响。</li>
</ol>
<p><em>项目级微服务</em><br><img src="/Pasted%20image%2020231028202046.png" srcset="/img/loading.gif" lazyload><br>服务的组合和编排在应用层实现。</p>
<p><em>企业级微服务</em><br><img src="/Pasted%20image%2020231028202123.png" srcset="/img/loading.gif" lazyload><br>使用BFF微服务（服务于前端的微服务，没有领域模型）完成各个中台微服务的服务组合和编排。</p>
<p><em>整洁架构和六边形架构的区别？</em><br>整洁架构规定了层之间的依赖关系规则：内层（高层）不依赖外层（低层），六边形架构层之间的依赖关系也遵从此规则。<strong>可以认为整洁架构是一种架构设计的指导思想，六边形架构是整洁架构的一种具体的架构设计。</strong><br>采用依赖倒置原则后的分层架构和<strong>六边形架构</strong>，实际上都符合整洁架构设计理念。但是六边形架构中使用端口与适配器，让应用程序能够以一致的方式被用户、程序、自动化测试、批处理脚本所驱动，同时能够让应用程序边界更加清晰，从而能更好地防止领域层和应用层逻辑泄露到外层。</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://juejin.cn/post/7256795117675216952?from=search-suggest">DDD架构为什么应该首选六边形架构？ | 京东云技术团队</a></p>
</blockquote>
<h1 id="DDD与中台建模"><a href="#DDD与中台建模" class="headerlink" title="DDD与中台建模"></a>DDD与中台建模</h1><h2 id="中台介绍"><a href="#中台介绍" class="headerlink" title="中台介绍"></a>中台介绍</h2><p><em>平台与中台区别</em></p>
<ul>
<li>背景：阿里<strong>业务中台</strong>的前身是<strong>共享平台</strong>，而原来的共享平台更多的被当作资源团队，他们承接各业务方的需求，并为业务方在基础服务上做定制开发。</li>
<li>目标：将核心的服务链路整体当作一个平台产品来做，为前端业务提供业务解决方案。</li>
<li>区别：平台只是将通用的公共能力独立为共享平台，其并没有与企业内其他平台或应用等实现全面融合，也没有将核心业务服务链路作为一个整体方案考虑，各平台之间是分离且独立的。</li>
</ul>
<p><em>中台的定义</em><br>中台是<strong>企业级能力</strong>复用平台。其相比平台，有以下特点：</p>
<ol>
<li>对前台业务的快速响应能力；</li>
<li>企业级复用能力；</li>
<li>从前台、中台到后台的设计、研发、页面等的无缝联通、融合能力。</li>
</ol>
<p><em>中台应该共享什么？</em><br>业务中台：解决核心业务链路的<strong>联通</strong>和不同渠道服务<strong>共享</strong>的问题。<br>数据中台：解决系统微服务拆分后的<strong>数据孤岛</strong>、数据融合和业务创新等问题。</p>
<h2 id="前中后台协同"><a href="#前中后台协同" class="headerlink" title="前中后台协同"></a>前中后台协同</h2><p><em>前、中、后台的定义</em><br>阿里对前、中、后台的定义：前台主要面向客户以及终端销售者，实现营销推广以及交易转化，中台主要面向运营人员完成运营支撑，后台主要面向后台管理人员，实现流程审核、内部管理以及后勤支撑，比如采购、人力、财务和 OA 等系统。</p>
<p><em>前台</em></p>
<ul>
<li>传统企业的早期系统，<strong>每个系统都有自己的前端</strong>，相互独立，用户需要登录多个系统才能完成完整业务流程。</li>
<li>中台后的前台需要有一套综合考虑业务边界、流程和平台的整体解决方案，以达到不管后端有多少中台，前端用户感受到的就是<strong>只有一个前台</strong>。</li>
</ul>
<p><em>业务中台</em></p>
<ul>
<li>传统企业核心业务基于集中式架构开发，没有扩展性和弹性伸缩能力，难以快速响应前端一线业务。</li>
<li><strong>业务中台</strong>的建设可采用领域驱动设计方法，通过领域建模，将可复用的公共能力从各个单体剥离，沉淀并组合，采用微服务架构模式，建设成为可共享的通用能力中台。</li>
</ul>
<p><em>数据中台</em><br>数据中台的主要目标是打通数据孤岛，实现业务融合和创新，包括三大主要职能：</p>
<ul>
<li>完成企业全域数据的采集与存储，实现各不同业务类别<strong>中台数据的汇总和集中管理</strong>；</li>
<li>按照标准的数据规范或数据模型，<strong>将数据</strong>按照不同主题域或场景进行加工和<strong>处理形成面向不同主题和场景的数据应用</strong>，比如客户视图、代理人视图、渠道视图、机构视图等不同数据体系；</li>
<li>建立业务需求驱动的数据体系，基于各个维度的数据，<strong>深度萃取数据价值，支持业务和商业模式的创新</strong>；</li>
</ul>
<p><em>后台</em><br>主要为实现内部的管理需求，一般可以考虑按角色或岗位进行功能聚合，将复杂的管理需求从业务领域中剥离开。</p>
<p><em>总结</em><br>前台通过页面和流程共享实现不同渠道应用之间的前台融合，中台通过 API 实现服务共享。而前台、业务中台和数据中台的融合可以实现传统应用与互联网应用的融合，从而解决“后端双核心、前端两张皮”的问题。能力复用了，前台流程和数据融合了，才能更好地支持业务的融合和商业模式的创新。</p>
<h2 id="DDD、中台和微服务协作"><a href="#DDD、中台和微服务协作" class="headerlink" title="DDD、中台和微服务协作"></a>DDD、中台和微服务协作</h2><p>中台是抽象出来的业务模型，微服务是业务模型的系统实现，DDD作为方法论可以同时指导中台业务建模和微服务建设，三者相辅相成。<br><img src="/Pasted%20image%2020231029013115.png" srcset="/img/loading.gif" lazyload></p>
<p><em>中台的本质</em><br>中台的本质其实就是提炼各个业务板块的共同需求，进行业务和系统抽象，形成通用的可复用的业务模型，打造成组件化产品，供前台部门使用。<strong>前台要做什么业务，需要什么资源可以直接找中台，不需要每次都去改动自己的底层。</strong></p>
<p><em>DDD、中台和微服务的协作</em><br><img src="/Pasted%20image%2020231029013045.png" srcset="/img/loading.gif" lazyload></p>
<p><em>中台如何建模</em></p>
<ol>
<li>将业务域细分为多个中台，根据功能属性和重要性归类到核心中台或通用中台。</li>
<li>选择具体中台，事件风暴后找出实体、聚合和限界上下文，进行领域分解、建立领域模型。</li>
<li>以主领域模型为基础，扫描其他中台领域模型，检查是否有重复或需要重组的领域对象。</li>
<li>选择其他主领域模型重复第3步，直到所有主领域模型完成比对和重构。</li>
<li>完成微服务设计，完成系统落地。</li>
</ol>
<h2 id="DDD重构中台业务模型"><a href="#DDD重构中台业务模型" class="headerlink" title="DDD重构中台业务模型"></a>DDD重构中台业务模型</h2><p><em>重构策略</em></p>
<ol>
<li>自顶向下策略：先做顶层设计、从最高领域逐级分解为中台，分别建立领域模型。自顶向下的策略适用于<strong>全新的应用系统建设，或旧系统推倒重建的情况</strong>。</li>
<li>自底向上策略：基于业务和系统现状完成领域建模。自底向上策略<strong>适用于遗留系统业务模型的演进式重构</strong>。步骤一般有以下三步：<ol>
<li>锁定系统所在业务域，构建领域模型：找到各领域业务能力重复或分散的部分。</li>
<li>对齐业务域，构建中台业务模型：以互联网电商领域模型作为<strong>辅助模型</strong>构建中台业务模型。</li>
<li>中台归类，根据领域模型设计微服务：根据中台业务模型设计微服务。</li>
</ol>
</li>
</ol>
<blockquote>
<p>构建多业务域的中台业务模型的过程，就是找出同一业务域内所有同类业务的领域模型，对比分析域内领域模型和聚合的差异和共同点，打破原有的模型，完成新的中台业务模型重组或归并的过程。</p>
</blockquote>
<h1 id="DDD实战"><a href="#DDD实战" class="headerlink" title="DDD实战"></a>DDD实战</h1><h2 id="事件风暴"><a href="#事件风暴" class="headerlink" title="事件风暴"></a>事件风暴</h2><p><em>要点</em></p>
<ul>
<li>参与者：项目团队、领域专家</li>
<li>内容：枚举实体、目录、领域事件、其他信息，关注业务语言和行为。</li>
<li>步骤：<ol>
<li>产品愿景：确定产品方向</li>
<li>业务场景：将产生很多命令和领域事件</li>
<li>领域建模：分析依赖关系，组成聚合、划定限界上下文。</li>
<li>微服务拆分与设计：以领域模型作为拆分微服务的依据，而不是唯一标准。</li>
</ol>
</li>
</ul>
<h2 id="代码模型设计"><a href="#代码模型设计" class="headerlink" title="代码模型设计"></a>代码模型设计</h2><blockquote>
<p>DDD没有给出标准的代码模型，下面的设计只是一个参考。</p>
</blockquote>
<p><em>设计案例</em><br><img src="/Pasted%20image%2020231031183128.png" srcset="/img/loading.gif" lazyload></p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs perl">- com.$&#123;company&#125;.$&#123;system&#125;.$&#123;appname&#125;<br>|- interfaces(用户接口层)<br>  |- assembler(实现DTO与领域对象的转换)<br>  |- dto(数据传输载体)<br>  |- facade(调用接口)<br>|- application(应用层)<br>  |- service(服务)<br>    |- impl<br>  |- event(事件，领域层和应用层都可以存放，但为了事件管理的统一性，建议放在应用层)<br>    |- publish<br>	|- subscribe<br>|- domain(领域层)<br>  |- domain1(领域<span class="hljs-number">01</span>)<br>	|- service(领域服务)<br>	|- entity(领域实体)<br>	|- event(领域事件)<br>	|- repository(仓库接口)<br>|- infrastructure(基础设施层)<br>  |- dal(数据访问层)<br>    |-dao<br>  |- mapper<br>  |- factory<br>  |- utils<br></code></pre></td></tr></table></figure>

<p><em>异常处理</em><br>Interface层的HTTP和RPC接口，返回值为Result，捕捉所有异常。<br>Application层的所有接口返回值为DTO，不负责处理异常。</p>
<p><em>Facade层</em><br>为远程客户端提供粗粒度的调用接口，他的作用就是将一个用户请求委派给一个或多个service进行处理。</p>
<p><em>防腐层</em><br>Anti-Corruption Layer（防腐层或ACL）。很多时候我们的系统会去依赖其他的系统，通过在系统间加入一个防腐层，能够有效的隔离外部依赖和内部逻辑，无论外部如何变更，内部代码可以尽可能的保持不变。<br>ACL防腐层的实现方式：</p>
<ul>
<li>对于依赖的外部对象，我们抽取出所需要的字段，生成一个内部所需的VO或DTO类。</li>
<li>构建一个新的Facade，在Facade中封装调用链路，将外部类转化为内部类。</li>
<li>针对外部系统调用，同样的用Facade方法封装外部调用链路。</li>
</ul>
<blockquote>
<p>在一些理论框架里ACL Facade也被叫做Gateway，含义是一样的。</p>
</blockquote>
<p><em>各种O</em></p>
<ul>
<li>DAO （Data Access Object）数据访问对象</li>
<li>DTO（Data Transfer Object）数据传输对象</li>
<li>DO （Domain Object）领域对象</li>
<li>VO（View Object）视图模型</li>
<li>AO（Application Object）应用对象</li>
<li>BO（ Business Object）业务对象</li>
<li>POJO（Plain Ordinary Java Object）纯普通Java对象</li>
<li>PO（Persistent Object）持久化对象</li>
<li>Entity（应用程序域中的一个概念）实体</li>
<li>Model （概念实体模型）实体类和模型</li>
<li>View （概念视图模型）视图模型</li>
</ul>
<p><em>总结</em></p>
<ol>
<li>聚合之间的代码边界要清晰</li>
<li>要有代码分层的概念</li>
</ol>
<p><em>保证领域模型与代码模型的一致性</em></p>
<ol>
<li>整理事件风暴的内容为一个表格，包含领域模型、聚合、领域对象、领域对象类型</li>
<li>微服务化：<ol>
<li>设计实体：设计Entity对象</li>
<li>找出聚合根：同一个聚合的实体放在同一个领域的Entity目录</li>
<li>设计值对象：设计值对象放在对应领域的Entity目录</li>
<li>设计领域事件：设计实践并将Event类和Handler类放在服务层的Event目录</li>
<li>设计领域服务：设计服务并放在领域层的Service目录</li>
<li>设计仓储：设计仓储接口放在领域层的Repository目录</li>
</ol>
</li>
<li>服务的封装与调用<ol>
<li>实体方法的封装，用DomainService和AppService区分<strong>领域服务</strong>或<strong>应用服务</strong></li>
<li>领域服务对同一领域的多个实体方法进行组合编排</li>
<li>应用服务对多个领域的服务进行组合编排，暴露给用户接口层</li>
</ol>
</li>
<li>建立领域对象与微服务代码对象的映射</li>
</ol>
<blockquote>
<p>对于一些业务场景可能无法设计出典型的领域模型，如找不到聚合根，此时可以借鉴聚合的思想，用聚合来定义这部分功能。</p>
</blockquote>
<h2 id="微服务边界"><a href="#微服务边界" class="headerlink" title="微服务边界"></a>微服务边界</h2><p><em>演进式架构</em><br>演进式架构就是以支持增量的、非破坏的变更作为第一原则，同时支持在应用程序结构层面的多维度变化。微服务设计的重点，就是看微服务设计是否能够支持架构长期、轻松的演进。</p>
<p><em>边界</em></p>
<ul>
<li>逻辑边界：微服务内聚合之间的边界是逻辑边界。它是一个虚拟的边界，强调业务的内聚。<strong>可根据需要变成物理边界，也就是说聚合也可以独立为微服务。</strong></li>
<li>物理边界:微服务之间的边界是物理边界。它强调微服务部署和运行的隔离，关注微服务的服务调用、容错和运行等。</li>
<li>代码边界: 不同层或者聚合之间代码目录的边界是代码边界。它强调的是代码之间的隔离方便架构演进时代码的重组。</li>
</ul>
<h2 id="微服务视图"><a href="#微服务视图" class="headerlink" title="微服务视图"></a>微服务视图</h2><p><em>服务依赖关系</em></p>
<ul>
<li>松散分层架构：领域层服务和实体方法直接暴露给应用层和用户接口层，无需逐级封装。（开发效率更高）</li>
<li>严格分层架构：每一层服务只向紧邻的上一层提供服务，实体方法值暴露给领域服务，由领域服务暴露给应用层。（可管理性更好）</li>
</ul>
<p><em>数据对象视图</em><br><img src="/Pasted%20image%2020231031185337.png" srcset="/img/loading.gif" lazyload></p>
<h2 id="微服务前端设计"><a href="#微服务前端设计" class="headerlink" title="微服务前端设计"></a>微服务前端设计</h2><p><em>微前端</em><br>为了解决单体前端的问题，我们可以借鉴微服务的设计思想，引入<strong>微前端</strong>概念：在前端设计时我们需要遵循单一职责和复用原则，按照领域模型和微服务边界，将前端页面进行拆分。同时构建多个可以<strong>独立部署、完全自治、松耦合的页面组合</strong>，其中每个组合只负责特定业务单元的 UI 元素和功能，这些页面组合就是<strong>微前端</strong>。</p>
<p><em>业务单元组合</em></p>
<ol>
<li>单一业务单元：一个微前端对应一个微服务</li>
<li>组合业务单元：一个微前端对应多个微服务</li>
<li>通用共享业务单元：一个微前端与若干微服务组成通用业务单元，以共享页面的方式与其他微前端页面协作</li>
</ol>
<p><em>微前端集成</em><br>微服务位于前端和微服务之间，因此其需要完成与这两方的集成：</p>
<ol>
<li>微前端与前端主页面集成：通过页面路由、微前端注册等方式实现</li>
<li>微前端与微服务集成：类似传统前后端集成</li>
</ol>
<p><em>职责边界</em></p>
<ul>
<li>前端项目团队：只需要完成企业级前端主页面与业务单元的融合，前端只关注前端主页面与微前端页面之间的集成。</li>
<li>中台项目团队：关注业务单元功能的完整性和自包含能力，完成业务单元内微服务和微前端开发、集成和部署，提供业务单元组件。</li>
</ul>
<h2 id="微服务设计原则"><a href="#微服务设计原则" class="headerlink" title="微服务设计原则"></a>微服务设计原则</h2><p><em>微服务演进策略</em></p>
<ul>
<li>绞杀者策略：整体重构，用微服务逐步替换原单体系统</li>
<li>修缮者策略：部分重构，在现有系统的基础上<strong>剥离影响整体业务的功能</strong>独立为微服务</li>
</ul>
<p><em>不同场景建模策略</em></p>
<ul>
<li>新建系统<ul>
<li>简单领域系统：直接事件风暴即可</li>
<li>复杂领域系统：拆分子域建立领域模型、领域模型微调、微服务设计</li>
</ul>
</li>
<li>遗留系统：修缮者策略，取性能瓶颈的模块拆分为微服务</li>
</ul>
<p><em>微服务设计原则</em></p>
<ul>
<li>领域驱动设计，拒绝数据驱动或界面驱动</li>
<li>清晰微服务的边界</li>
<li>清晰微服务分层的职能</li>
<li>不做过度拆分</li>
</ul>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/%E6%9E%B6%E6%9E%84%E5%AD%A6%E4%B9%A0/" class="category-chain-item">架构学习</a>
  
  
    <span>></span>
    
  <a href="/categories/%E6%9E%B6%E6%9E%84%E5%AD%A6%E4%B9%A0/DDD%E5%BB%BA%E6%A8%A1/" class="category-chain-item">DDD建模</a>
  
  

  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/DDD/">#DDD</a>
      
        <a href="/tags/%E6%9E%B6%E6%9E%84%E5%AD%A6%E4%B9%A0/">#架构学习</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>DDD建模语言圣经</div>
      <div>http://example.com/2023/01/06/架构学习/DDD建模/DDD建模/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>Jin</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2023年1月6日</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>许可协议</div>
          <div>
            
              
              
                <a target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - 署名">
                    <i class="iconfont icon-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2023/01/06/%E6%A6%82%E5%BF%B5%E6%95%B4%E7%90%86/Java/Java%E5%9F%BA%E7%A1%80/Java%E7%AC%AC1%E7%AB%A0%EF%BC%88%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%EF%BC%89/" title="Java第1章（面向对象）">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">Java第1章（面向对象）</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2023/01/06/%E6%A6%82%E5%BF%B5%E6%95%B4%E7%90%86/Golang/Go%E8%AF%AD%E8%A8%80%E5%9C%A3%E7%BB%8F/" title="Go语言圣经">
                        <span class="hidden-mobile">Go语言圣经</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
  <article id="comments" lazyload>
    
  <div id="twikoo"></div>
  <script type="text/javascript">
    Fluid.utils.loadComments('#comments', function() {
      Fluid.utils.createScript('https://lib.baomitu.com/twikoo/1.6.7/twikoo.all.min.js', function() {
        var options = Object.assign(
          {"envId":"https://twikoo-api-lime.vercel.app/","region":"ap-shanghai","path":"window.location.pathname"},
          {
            el: '#twikoo',
            path: 'window.location.pathname',
            onCommentLoaded: function() {
              var imgSelector = '#twikoo .tk-content img:not(.tk-owo-emotion)';
              Fluid.plugins.imageCaption(imgSelector);
              Fluid.plugins.fancyBox(imgSelector);
            }
          }
        )
        twikoo.init(options)
      });
    });
  </script>
  <noscript>Please enable JavaScript to view the comments</noscript>


  </article>


          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <div> <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> </div> 
    </div>
  
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.0/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.18.2/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>




  
<script src="/js/fluid-extention.js"></script>



<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
</body>
</html>
